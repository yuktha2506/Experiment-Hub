<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ExperimentHub - Staff Dashboard</title>
  <link rel="icon" href="pic.png" type="image/png">
  <style>
    /* ===== RESET & GLOBAL STYLES ===== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg1: #0b1023;
      --bg2: #0f1b3d;
      --card: rgba(255, 255, 255, .08);
      --stroke: rgba(255, 255, 255, .16);
      --text: rgba(255, 255, 255, .92);
      --muted: rgba(255, 255, 255, .72);
      --brand1: #7c5cff;
      --brand2: #23d5ab;
      --radius: 18px;
      --shadow: 0 18px 60px rgba(0, 0, 0, .35);
      --success: #4CAF50;
      --error: #f44336;
      --warning: #ff9800;
    }

    body {
      min-height: 100vh;
      font-family: system-ui, Segoe UI, Roboto, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1200px 900px at 15% 15%, #14265a 0%, transparent 60%),
        radial-gradient(1000px 800px at 85% 20%, #2e145a 0%, transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }

    /* ===== NAVBAR ===== */
    .navbar {
      background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .03));
      border-bottom: 1px solid var(--stroke);
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      backdrop-filter: blur(10px);
    }

    .navbar-brand {
      font-size: 24px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--brand1), var(--brand2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .navbar-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .user-greeting {
      color: var(--muted);
      font-size: 14px;
      font-weight: 500;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 12px;
      border: 1px solid var(--stroke);
      background: rgba(255, 255, 255, .04);
      color: var(--text);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn:hover {
      background: rgba(255, 255, 255, .08);
      border-color: var(--brand2);
      color: var(--brand2);
    }

    .btn-logout {
      background: rgba(244, 67, 54, .15);
      border-color: rgba(244, 67, 54, .4);
      color: #ff8a80;
    }
    .btn-logout:hover {
      background: rgba(244, 67, 54, .25);
      border-color: rgba(244, 67, 54, .6);
      color: #ffcdd2;
    }

    /* ===== DASHBOARD LAYOUT ===== */
    .dashboard-container {
      display: grid;
      grid-template-columns: 250px 1fr;
      min-height: calc(100vh - 80px);
    }

    @media (max-width: 1024px) {
      .dashboard-container {
        grid-template-columns: 1fr;
      }
    }

    /* ===== SIDEBAR ===== */
    .sidebar {
      background: linear-gradient(180deg, rgba(255, 255, 255, .06), rgba(255, 255, 255, .02));
      border-right: 1px solid var(--stroke);
      padding: 30px 20px;
    }

    @media (max-width: 1024px) {
      .sidebar {
        border-right: none;
        border-bottom: 1px solid var(--stroke);
      }
    }

    .sidebar h3 {
      font-size: 18px;
      margin-bottom: 25px;
      color: var(--text);
      font-weight: 600;
      background: linear-gradient(135deg, var(--brand1), var(--brand2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      padding-left: 10px;
    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar li {
      margin-bottom: 10px;
    }

    .nav-link {
      display: block;
      padding: 14px 20px;
      color: var(--muted);
      text-decoration: none;
      border-radius: 12px;
      transition: all 0.3s ease;
      font-weight: 500;
      border: 1px solid transparent;
      cursor: pointer;
    }

    .nav-link:hover {
      background: rgba(255, 255, 255, .04);
      color: var(--text);
    }

    .nav-link.active {
      background: rgba(124, 92, 255, .1);
      color: var(--brand2);
      border-color: rgba(124, 92, 255, .2);
    }

    /* ===== MAIN CONTENT ===== */
    .main-content {
      padding: 30px;
      overflow-y: auto;
    }

    @media (max-width: 768px) {
      .main-content {
        padding: 20px;
      }
    }

    /* Fix for dropdown visibility */
select {
  background-color: var(--bg2); /* Matches your dark theme background */
  color: var(--text);           /* White text for the selected value */
  cursor: pointer;
}

select option {
  background-color: #1a264d;    /* A solid dark color for the dropdown list */
  color: #ffffff;               /* Clear white text for the options */
}
.section {
  display: none !important;
}

    .section.active {
      display: block !important;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== SECTION CARDS ===== */
    .section-card {
      background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .03));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      padding: 30px;
      box-shadow: var(--shadow);
    }

    @media (max-width: 768px) {
      .section-card {
        padding: 20px;
      }
    }

    .section-card h2 {
      font-size: 28px;
      margin-bottom: 30px;
      color: var(--text);
      font-weight: 700;
    }

    @media (max-width: 768px) {
      .section-card h2 {
        font-size: 24px;
        margin-bottom: 20px;
      }
    }

    /* ===== FORM STYLES ===== */
    .form-group {
      margin-bottom: 25px;
    }

    .form-group label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--muted);
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 15px 18px;
      background: rgba(255, 255, 255, .04);
      border: 1px solid var(--stroke);
      border-radius: 12px;
      color: var(--text);
      font-size: 16px;
      font-family: inherit;
      transition: all 0.3s ease;
    }

    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }

    .form-group input::placeholder,
    .form-group textarea::placeholder {
      color: rgba(255, 255, 255, .4);
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      background: rgba(255, 255, 255, .08);
      border-color: var(--brand1);
      box-shadow: 0 0 0 3px rgba(124, 92, 255, .2);
    }

    .form-group select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='rgba(124,92,255,0.8)' d='M1 1l5 5 5-5'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 15px center;
      padding-right: 40px;
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
      }
    }

    /* ===== FILE INPUT ===== */
    .file-input-wrapper {
      position: relative;
      margin-bottom: 10px;
    }

    .file-input-wrapper input[type="file"] {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
      z-index: 2;
    }

    .file-input-wrapper .file-name {
      display: block;
      padding: 15px 18px;
      background: rgba(255, 255, 255, .04);
      border: 1px solid var(--stroke);
      border-radius: 12px;
      color: var(--muted);
      font-size: 16px;
    }

    .file-input-wrapper:hover .file-name {
      background: rgba(255, 255, 255, .08);
      border-color: var(--brand1);
    }

    .form-group small {
      display: block;
      color: rgba(255, 255, 255, .5);
      font-size: 12px;
      margin-top: 5px;
    }

    /* ===== BUTTONS ===== */
    .btn-primary {
      background: linear-gradient(135deg, var(--brand1), var(--brand2));
      border: none;
      color: white;
      padding: 16px 32px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(124, 92, 255, .3);
    }

    .btn-large {
      padding: 18px 32px;
      font-size: 18px;
    }

    /* ===== MESSAGE STYLES ===== */
    .message {
      padding: 15px 20px;
      border-radius: 12px;
      margin-top: 20px;
      font-size: 14px;
      font-weight: 500;
      animation: fadeIn 0.3s ease;
    }

    .message.success {
      background: rgba(76, 175, 80, .15);
      border: 1px solid rgba(76, 175, 80, .3);
      color: #a5d6a7;
    }

    .message.error {
      background: rgba(244, 67, 54, .15);
      border: 1px solid rgba(244, 67, 54, .3);
      color: #ffabab;
    }

    .message.info {
      background: rgba(33, 150, 243, .15);
      border: 1px solid rgba(33, 150, 243, .3);
      color: #90caf9;
    }

    /* ===== EXPERIMENTS GRID (My Experiments Section) ===== */
    .filters {
      background: linear-gradient(180deg, rgba(255, 255, 255, .06), rgba(255, 255, 255, .02));
      border: 1px solid var(--stroke);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 30px;
    }

    .filters h3 {
      font-size: 18px;
      margin-bottom: 16px;
      color: var(--text);
      font-weight: 600;
      background: linear-gradient(135deg, var(--brand1), var(--brand2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .filters label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      color: var(--muted);
      margin-top: 14px;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .filters input,
    .filters select {
      width: 100%;
      padding: 10px 12px;
      background: rgba(255, 255, 255, .04);
      border: 1px solid var(--stroke);
      border-radius: 10px;
      color: var(--text);
      font-size: 14px;
      font-family: inherit;
      transition: all 0.2s ease;
    }

    .filters input::placeholder {
      color: rgba(255, 255, 255, .4);
    }

    .filters input:focus,
    .filters select:focus {
      outline: none;
      background: rgba(255, 255, 255, .08);
      border-color: var(--brand1);
      box-shadow: 0 0 12px rgba(124, 92, 255, .2);
    }

    .filters select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='rgba(124,92,255,0.8)' d='M1 1l5 5 5-5'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      padding-right: 32px;
      color: #23d5ab;
      font-weight: 500;
    }

    .filter-actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .filter-actions button {
      flex: 1;
      padding: 12px 16px;
      border-radius: 10px;
      border: 1px solid var(--stroke);
      background: transparent;
      color: var(--text);
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    .filter-actions button:hover {
      background: rgba(255, 255, 255, .08);
      border-color: var(--brand2);
      color: var(--brand2);
    }

    .filter-actions .apply {
      background: linear-gradient(135deg, var(--brand1), var(--brand2));
      border: none;
      color: white;
    }

    .filter-actions .apply:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(124, 92, 255, .3);
      background: linear-gradient(135deg, rgba(124, 92, 255, 1), rgba(35, 213, 171, 1));
    }

    /* ===== GRID & CARDS ===== */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      position: relative;
      background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .03));
      border: 1px solid rgba(255, 255, 255, .14);
      border-radius: 16px;
      padding: 20px;
      transition: all 0.3s ease;
    }

    .card:hover {
      border-color: rgba(124, 92, 255, .3);
      background: linear-gradient(180deg, rgba(124, 92, 255, .06), rgba(35, 213, 171, .03));
      box-shadow: 0 0 20px rgba(124, 92, 255, .1);
      transform: translateY(-5px);
    }

    .card-actions {
      position: absolute;
      top: 15px;
      right: 15px;
      display: flex;
      gap: 10px;
    }

    .card-action-btn {
      background: rgba(255, 255, 255, .1);
      border: 1px solid rgba(255, 255, 255, .2);
      color: var(--text);
      width: 36px;
      height: 36px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 16px;
    }

    .card-action-btn:hover {
      transform: scale(1.1);
    }

    .card-action-btn.edit:hover {
      background: rgba(33, 150, 243, .3);
      border-color: rgba(33, 150, 243, .5);
      color: #90caf9;
    }

    .card-action-btn.delete:hover {
      background: rgba(244, 67, 54, .3);
      border-color: rgba(244, 67, 54, .5);
      color: #ff8a80;
    }

    .card h4 {
      font-size: 18px;
      margin-bottom: 15px;
      color: var(--text);
      padding-right: 50px;
    }

    .tags {
      display: flex;
      gap: 8px;
      margin: 10px 0;
      flex-wrap: wrap;
    }

    .tag {
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 12px;
      background: rgba(255, 255, 255, .06);
      border: 1px solid rgba(255, 255, 255, .12);
      color: var(--muted);
      transition: all 0.2s ease;
    }

    .tag.subject-science {
      background: rgba(244, 67, 54, .15);
      border-color: rgba(244, 67, 54, .3);
      color: rgba(244, 67, 54, .9);
    }

    .tag.subject-maths {
      background: rgba(33, 150, 243, .15);
      border-color: rgba(33, 150, 243, .3);
      color: rgba(33, 150, 243, .9);
    }

    .tag.level-easy {
      background: rgba(76, 175, 80, .15);
      border-color: rgba(76, 175, 80, .3);
      color: rgba(76, 175, 80, .9);
    }

    .tag.level-medium {
      background: rgba(255, 152, 0, .15);
      border-color: rgba(255, 152, 0, .3);
      color: rgba(255, 152, 0, .9);
    }

    .card p {
      font-size: 14px;
      color: var(--muted);
      line-height: 1.6;
      margin: 15px 0;
      max-height: 60px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid rgba(255, 255, 255, .1);
      font-size: 12px;
      color: rgba(255, 255, 255, .5);
    }

    /* ===== MODAL STYLES ===== */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .65);
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
    }

    .modal-card {
      width: 90%;
      max-width: 900px;
      max-height: 90vh;
      overflow: auto;
      background: linear-gradient(180deg, #121b3a, #0c1228);
      border-radius: 18px;
      padding: 30px;
      border: 1px solid var(--stroke);
      animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
      from { opacity: 0; transform: translateY(-50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .modal-header {
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 15px;
    }

    .modal-header h2 {
      margin-bottom: 10px;
      background: linear-gradient(135deg, var(--brand1), var(--brand2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 28px;
    }

    .modal-subtitle {
      color: var(--muted);
      font-size: 16px;
      margin-bottom: 15px;
      line-height: 1.5;
    }

    .modal-content {
      margin-bottom: 25px;
    }

    .modal-section {
      margin-bottom: 25px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      padding: 20px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .modal-section h4 {
      color: var(--brand2);
      margin-bottom: 15px;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .modal-section h4:before {
      content: "ðŸ“‹";
      font-size: 20px;
    }

    .procedure-list {
      padding-left: 20px;
    }

    .procedure-step {
      margin-bottom: 12px;
      padding-left: 10px;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.85);
    }

    .procedure-step:before {
      content: "â†’";
      color: var(--brand1);
      margin-right: 10px;
      font-weight: bold;
    }

    .video-section {
      margin-top: 25px;
      text-align: center;
    }

    .video-section h4 {
      color: var(--brand2);
      margin-bottom: 15px;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .video-section h4:before {
      content: "ðŸŽ¬";
      font-size: 20px;
    }

    .modal video {
      width: 100%;
      max-height: 400px;
      margin-top: 10px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .video-placeholder {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      border: 2px dashed rgba(255, 255, 255, 0.1);
      color: var(--muted);
    }

    .close {
      position: absolute;
      right: 20px;
      top: 20px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      transition: all 0.2s ease;
    }

    .close:hover {
      background: rgba(255, 50, 50, 0.3);
      transform: rotate(90deg);
    }

    /* ===== LOADING STATES ===== */
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--muted);
      font-style: italic;
    }

    .no-data {
      text-align: center;
      padding: 40px;
      color: var(--muted);
      font-size: 16px;
    }

    /* ===== PROCEDURE STEPS INPUT ===== */
    .procedure-steps {
      margin-top: 10px;
    }

    .procedure-step-input {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }

    .procedure-step-input input {
      flex: 1;
    }

    .procedure-step-input button {
      padding: 10px 15px;
      background: rgba(35, 213, 171, .2);
      border: 1px solid rgba(35, 213, 171, .3);
      color: rgba(35, 213, 171, .9);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .procedure-step-input button:hover {
      background: rgba(35, 213, 171, .3);
    }

    .procedure-step-input button.remove {
      background: rgba(244, 67, 54, .2);
      border-color: rgba(244, 67, 54, .3);
      color: rgba(244, 67, 54, .9);
    }

    .procedure-step-input button.remove:hover {
      background: rgba(244, 67, 54, .3);
    }

    .step-item {
      background: rgba(255, 255, 255, .04);
      border: 1px solid rgba(255, 255, 255, .1);
      border-radius: 8px;
      padding: 12px 15px;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .step-item .step-number {
      color: var(--brand1);
      font-weight: bold;
      margin-right: 10px;
      min-width: 20px;
    }

    .step-item .step-text {
      flex: 1;
      color: var(--text);
    }

    .step-item button {
      padding: 5px 10px;
      background: rgba(244, 67, 54, .2);
      border: 1px solid rgba(244, 67, 54, .3);
      color: rgba(244, 67, 54, .9);
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s ease;
    }

    .step-item button:hover {
      background: rgba(244, 67, 54, .3);
    }
  </style>
</head>
<body>
  <div class="dashboard">
    <nav class="navbar">
      <div class="navbar-brand">ExperimentHub </div>
      <div class="navbar-right">
        <span class="user-greeting">Welcome, Staff</span>
        <a href="staff-login.html" class="btn btn-logout">Logout</a>
      </div>
    </nav>

    <div class="dashboard-container">
      <div class="sidebar">
        <h3>Dashboard</h3>
        <ul>
  <li>
    <a class="nav-link active" onclick="showSection('upload')">
      ðŸ“¤ Add Experiment
    </a>
  </li>
  <li>
    <a class="nav-link" onclick="showSection('experiments')">
      ðŸ“š All Experiments
    </a>
  </li>
</ul>

      </div>

      <div class="main-content">
        <!-- Upload Section -->
        <section id="upload-section" class="section active">
          <div class="section-card">
            <h2>Add New Experiment</h2>
            <form id="upload-form">
              <div class="form-group">
                <label for="exp-title">Experiment Title *</label>
                <input type="text" id="exp-title" placeholder="Enter experiment title" required>
              </div>

              <div class="form-group">
                <label for="exp-description">Description</label>
                <textarea id="exp-description" placeholder="Describe the experiment idea" rows="4"></textarea>
              </div>

              <div class="form-group">
                <label for="exp-detailed-proc">Detailed Procedure *</label>
                <div id="procedure-steps-container" class="procedure-steps">
                  <!-- Steps will be added here -->
                </div>
                <div class="procedure-step-input">
                  <input type="text" id="new-step-input" placeholder="Enter a step in the procedure">
                  <button type="button" onclick="addProcedureStep()">Add Step</button>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="exp-subject">Subject *</label>
                  <select id="exp-subject" required>
                    <option value="">Select subject</option>
                    <option value="science">Science</option>
                    <option value="maths">Maths</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="exp-level">Difficulty Level *</label>
                  <select id="exp-level" required>
                    <option value="">Select difficulty</option>
                    <option value="easy">Easy</option>
                    <option value="medium">Medium</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="exp-class">Class *</label>
                  <select id="exp-class" required>
                    <option value="">Select class</option>
                    <option value="1-3">1-3</option>
                    <option value="4-6">4-6</option>
                    <option value="7-9">7-9</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="exp-video">Video URL (Optional)</label>
                <input type="text" id="exp-video" placeholder="https://www.youtube.com/embed/...">
                <small>Paste YouTube embed URL or any video URL</small>
              </div>

              <div class="form-group">
                <label for="exp-file">Upload Supporting Files (Optional)</label>
                <div class="file-input-wrapper">
                  <input type="file" id="exp-file" accept=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.xlsx,.pptx">
                  <span id="file-name" class="file-name">No file selected</span>
                </div>
                <small>Supported formats: PDF, DOC, DOCX, TXT, JPG, PNG, XLSX, PPTX (Max 10MB)</small>
              </div>

              <button type="button" onclick="handleUpload()" class="btn btn-primary btn-large" id="upload-btn">
                Add Experiment
              </button>
            </form>
            <div id="upload-message" class="message"></div>
          </div>
        </section>

        <!-- Experiments List Section -->
        <section id="experiments-section" class="section">
          <div class="section-card">
            <h2>All Experiments</h2>
            
            <!-- Filters -->
            <div class="filters">
              <h3>Filters</h3>

              <label>Search</label>
              <input id="f-search" placeholder="Try: solar, probability" oninput="filterExperiments()">

              <div class="form-row" style="grid-template-columns: repeat(3, 1fr); margin-top: 15px; gap: 15px;">
                <div class="form-group">
                  <label for="f-subject">Subject</label>
                  <select id="f-subject" onchange="filterExperiments()">
                    <option value="all">All</option>
                    <option value="science">Science</option>
                    <option value="maths">Maths</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="f-level">Difficulty</label>
                  <select id="f-level" onchange="filterExperiments()">
                    <option value="all">All</option>
                    <option value="easy">Easy</option>
                    <option value="medium">Medium</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="f-class">Class</label>
                  <select id="f-class" onchange="filterExperiments()">
                    <option value="all">All</option>
                    <option value="1-3">1-3</option>
                    <option value="4-6">4-6</option>
                    <option value="7-9">7-9</option>
                  </select>
                </div>
              </div>

              <div class="filter-actions">
                <button onclick="clearFilters()">Clear</button>
                <button class="apply" onclick="filterExperiments()">Apply</button>
              </div>
            </div>

            <!-- Experiments Grid -->
            <div class="grid" id="experiments-grid">
              <!-- Experiments will be loaded here -->
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Modal for Viewing Experiment Details -->
  <div class="modal" id="modal">
    <div class="modal-card">
      <button class="close" onclick="closeModal()">âœ•</button>
      <div class="modal-header">
        <h2 id="m-title"></h2>
        <div class="modal-subtitle" id="m-desc"></div>
      </div>
      
      <div class="modal-content">
        <div class="modal-section">
          <h4>Detailed Procedure</h4>
          <ol class="procedure-list" id="m-procedure"></ol>
        </div>
        
        <div class="video-section">
          <h4>Video Demonstration</h4>
          <div id="video-container">
            <!-- Video will be inserted here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Global variables - All 20+ experiments from student dashboard
    let experiments = [
      {
        id: "1",
        title: "Fibonacci in Nature",
        subject: "maths",
        level: "easy",
        class: "4-6",
        description: "Observe Fibonacci patterns in plants and shells.",
        detailedProc: [
          "Collect different flowers, pinecones, and fruits from your garden or park",
          "Carefully count the number of petals on flowers like daisies, sunflowers, and lilies",
          "For pinecones, count the number of spirals going clockwise and counterclockwise",
          "For sunflower heads, count the number of seeds spiraling in both directions",
          "Record all your counts in a table",
          "Compare your counts with the Fibonacci sequence: 1, 1, 2, 3, 5, 8, 13, 21, 34...",
          "Create a chart showing which plants follow Fibonacci patterns",
          "Take photographs of your findings to document the patterns"
        ],
        videoLink: "https://www.youtube.com/embed/SjSHVDfXHQ4",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "2",
        title: "Pascal's Triangle & Probability",
        subject: "maths",
        level: "medium",
        class: "7-9",
        description: "Explore probability patterns using Pascal's triangle.",
        detailedProc: [
          "Start by drawing Pascal's Triangle up to row 10",
          "Each number is the sum of the two numbers directly above it",
          "Notice patterns: the sums of each row are powers of 2",
          "Use the triangle to solve probability problems",
          "For coin tosses: row 2 gives probabilities for 2 tosses (1:2:1)",
          "For dice games: use combinations from the triangle",
          "Create your own probability games using the triangle",
          "Compare theoretical probabilities with experimental results by actually tossing coins"
        ],
        videoLink: "https://www.youtube.com/embed/XMriWTvPXHI",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "3",
        title: "Solar Cooker (Pizza Box)",
        subject: "science",
        level: "easy",
        class: "4-6",
        description: "Convert sunlight into heat energy to cook food.",
        detailedProc: [
          "Take a clean pizza box and line the inside with aluminum foil",
          "Cover the foil with black construction paper to absorb heat",
          "Cut a flap in the lid and cover it with plastic wrap to create a window",
          "Use a stick to prop the flap open at the best angle to catch sunlight",
          "Place marshmallows or chocolate pieces on a small plate inside",
          "Point the solar cooker toward direct sunlight",
          "Measure the temperature inside every 10 minutes using a thermometer",
          "Wait 30-60 minutes and enjoy your melted snack!",
          "Experiment with different angles and box colors"
        ],
        videoLink: "https://www.youtube.com/embed/M7w1AYy4-Nk",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "4",
        title: "DIY Water Filter",
        subject: "science",
        level: "medium",
        class: "4-6",
        description: "Filter dirty water using natural materials.",
        detailedProc: [
          "Cut the bottom off a plastic bottle to use as your filter",
          "Layer materials from bottom to top: cotton ball, fine sand, coarse sand, small pebbles",
          "Add activated charcoal (from crushed charcoal tablets) between sand layers",
          "Pour dirty water (mix soil with clean water) into the top",
          "Place a clean container under the filter to catch clean water",
          "Observe how each layer removes different impurities",
          "Test the filtered water for clarity and sediment",
          "Compare with unfiltered water samples",
          "Try different layer combinations to see which works best"
        ],
        videoLink: "https://www.youtube.com/embed/6Q0QHj-pNQM",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "5",
        title: "Electromagnet Strength",
        subject: "science",
        level: "medium",
        class: "7-9",
        description: "Effect of coil turns on magnetism.",
        detailedProc: [
          "Wrap insulated copper wire around a large iron nail",
          "Start with 20 turns and leave long wire ends",
          "Connect the wire ends to a D-cell battery (use alligator clips)",
          "Test how many paperclips the electromagnet can pick up",
          "Increase turns to 40, 60, 80, 100 and retest each time",
          "Record results in a table: turns vs. paperclips lifted",
          "Try different core materials: steel nail, copper rod, pencil",
          "Test with different battery strengths (1.5V, 3V, 4.5V)",
          "Always disconnect the battery when not testing to prevent overheating"
        ],
        videoLink: "https://www.youtube.com/embed/sFC7tLI8FTo",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "6",
        title: "Acid Base Indicator",
        subject: "science",
        level: "easy",
        class: "4-6",
        description: "Make indicator using red cabbage.",
        detailedProc: [
          "Chop half a red cabbage into small pieces",
          "Boil in water for 10 minutes until the water turns purple",
          "Strain the liquid and let it cool - this is your indicator",
          "Prepare test liquids: lemon juice, vinegar, baking soda solution, soap water, milk",
          "Pour small amounts of indicator into separate clear cups",
          "Add different test liquids to each cup",
          "Observe color changes: pink/red = acid, blue/green = base",
          "Create a color chart showing pH range from acid to base",
          "Test unknown household liquids and guess their pH"
        ],
        videoLink: "https://www.youtube.com/embed/MiYst3mQ-7Q",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "7",
        title: "Pendulum Time vs Length",
        subject: "science",
        level: "medium",
        class: "7-9",
        description: "Study relationship between pendulum length and time.",
        detailedProc: [
          "Tie a weight (metal washer) to a string",
          "Start with 50cm length from pivot point to center of weight",
          "Pull pendulum back 10 degrees and release (small angle)",
          "Time 10 complete swings with a stopwatch",
          "Calculate period (time for one swing) by dividing total time by 10",
          "Repeat for lengths: 25cm, 50cm, 75cm, 100cm, 125cm",
          "Keep release angle and weight constant for all tests",
          "Plot graph: length vs period squared",
          "Verify that period is proportional to square root of length"
        ],
        videoLink: "https://www.youtube.com/embed/7WZE5s5bG_g",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "8",
        title: "Simple Circuits",
        subject: "science",
        level: "easy",
        class: "4-6",
        description: "Build basic electrical circuits.",
        detailedProc: [
          "Connect a D-cell battery to a small light bulb using wires",
          "Add a switch to turn the light on and off",
          "Build a series circuit with 2 bulbs - observe what happens",
          "Build a parallel circuit with 2 bulbs - compare with series",
          "Add different resistors and observe brightness changes",
          "Test conductivity of various materials: coin, pencil lead, plastic, wood",
          "Build a simple circuit with a buzzer instead of a bulb",
          "Create a conductivity tester for liquids",
          "Always disconnect batteries when not in use"
        ],
        videoLink: "https://www.youtube.com/embed/QZPURSF5iH4",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "9",
        title: "Paper Airplanes",
        subject: "science",
        level: "easy",
        class: "1-3",
        description: "Test different airplane designs.",
        detailedProc: [
          "Fold 3 different paper airplane designs",
          "Design 1: Basic dart - pointy nose, narrow wings",
          "Design 2: Glider - wide wings, flat body",
          "Design 3: Stunt plane - curved wings for tricks",
          "Mark a starting line on the floor",
          "Throw each plane 5 times from the same position",
          "Measure distance from starting line to landing spot",
          "Record results in a table",
          "Note which design flies farthest and steadiest",
          "Try adding paper clips to the nose for balance"
        ],
        videoLink: "https://www.youtube.com/embed/3bT-kvX5N8s",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "10",
        title: "Sink or Float",
        subject: "science",
        level: "easy",
        class: "1-3",
        description: "Learn about buoyancy with everyday objects.",
        detailedProc: [
          "Fill a large container with water",
          "Collect test objects: coin, cork, plastic toy, metal spoon, eraser, apple",
          "Make predictions for each object: sink or float?",
          "Test each object one by one",
          "Record results in a chart: predicted vs actual",
          "Group objects that float together",
          "Group objects that sink together",
          "Try changing shape: mold clay into ball (sinks) vs boat shape (floats)",
          "Add salt to water and retest - some objects will float better!"
        ],
        videoLink: "https://www.youtube.com/embed/eQuW8G2XT_Q",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "11",
        title: "Magnet Exploration",
        subject: "science",
        level: "easy",
        class: "1-3",
        description: "Discover what objects magnets attract.",
        detailedProc: [
          "Collect various objects: paper clip, aluminum foil, copper coin, steel nail, plastic toy",
          "Test each object with a bar magnet",
          "Make two piles: magnetic and non-magnetic",
          "Discover that magnets only attract iron, nickel, and cobalt",
          "Try different magnet shapes: horseshoe, disc, bar",
          "Find the strongest part of the magnet (poles)",
          "Explore what happens when two magnets meet (attract/repel)",
          "Use magnets to sort mixed objects",
          "Make a simple compass by floating a magnetized needle"
        ],
        videoLink: "https://www.youtube.com/embed/s236Q1nuWXg",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "12",
        title: "Color Mixing",
        subject: "science",
        level: "easy",
        class: "1-3",
        description: "Create new colors by mixing primary colors.",
        detailedProc: [
          "Set up three cups with primary colors: red, yellow, blue (use food coloring)",
          "Use eye droppers or spoons to transfer colors",
          "Mix red + yellow = orange",
          "Mix blue + yellow = green",
          "Mix red + blue = purple",
          "Mix all three = brown",
          "Create a color wheel showing primary and secondary colors",
          "Try making different shades by adding more or less color",
          "Paint a rainbow using your mixed colors",
          "Experiment with mixing colored lights using flashlights and cellophane"
        ],
        videoLink: "https://www.youtube.com/embed/yu44JRTIxSQ",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "13",
        title: "Sound Absorption",
        subject: "science",
        level: "easy",
        class: "4-6",
        description: "Compare sound absorption of materials.",
        detailedProc: [
          "Place a smartphone playing a constant tone inside a box",
          "Test different box linings: cotton, foam, cardboard, aluminum foil",
          "Close the box lid securely",
          "Use a decibel meter app to measure sound level from 1 meter away",
          "Record readings for each material",
          "Test materials without box: curtains, carpet, pillows",
          "Create a sound-proof corner in a room",
          "Explain why soft materials absorb sound better",
          "Design the quietest possible box"
        ],
        videoLink: "https://www.youtube.com/embed/SSR6hUaqXLg",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "14",
        title: "Plant Growth",
        subject: "science",
        level: "easy",
        class: "1-3",
        description: "Observe how plants grow from seeds.",
        detailedProc: [
          "Plant bean seeds in clear plastic cups with soil",
          "Place some cups in sunlight, some in dark cupboard",
          "Water some regularly, others occasionally",
          "Measure plant height every 2 days",
          "Count number of leaves each week",
          "Record observations with drawings or photos",
          "Compare growth in different conditions",
          "Try different seeds: sunflower, pea, radish",
          "Chart the growth patterns over 3 weeks"
        ],
        videoLink: "https://www.youtube.com/embed/TX4m2BkF-0k",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "15",
        title: "Weather Chart",
        subject: "science",
        level: "easy",
        class: "1-3",
        description: "Track daily weather patterns.",
        detailedProc: [
          "Create a weather chart with columns: date, temperature, clouds, rain, wind",
          "Observe weather at the same time each day",
          "Use thermometer for temperature",
          "Note cloud types: cumulus (fluffy), stratus (layered), cirrus (wispy)",
          "Record rainfall in a homemade rain gauge",
          "Note wind direction using a wind vane",
          "Draw weather symbols for each day",
          "Predict tomorrow's weather based on patterns",
          "Create a monthly weather summary"
        ],
        videoLink: "https://www.youtube.com/embed/bE7DgKHwFk4",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "16",
        title: "Bottle Rocket Motion",
        subject: "science",
        level: "medium",
        class: "7-9",
        description: "Study projectile motion safely.",
        detailedProc: [
          "Take a plastic bottle and add 1/3 water",
          "Attach to bicycle pump using rubber stopper",
          "Launch at 30Â°, 45Â°, 60Â° angles",
          "Measure launch distance for each angle",
          "Record data in table: angle vs distance",
          "Find optimal launch angle (should be ~45Â°)",
          "Experiment with different water amounts",
          "Add fins for stability",
          "Launch in open area away from people",
          "Always wear safety glasses"
        ],
        videoLink: "https://www.youtube.com/embed/0LnG4lC61cU",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "17",
        title: "Mean Median Mode",
        subject: "maths",
        level: "easy",
        class: "4-6",
        description: "Analyze data using statistical measures.",
        detailedProc: [
          "Collect height data from 10 classmates",
          "Arrange heights in ascending order",
          "Calculate mean: sum of all heights Ã· number of people",
          "Find median: middle value when arranged in order",
          "Identify mode: most frequent height",
          "Create a frequency table",
          "Draw a bar graph of heights",
          "Collect another dataset: favorite colors",
          "Calculate measures for categorical data",
          "Compare which measure is best for different data types"
        ],
        videoLink: "https://www.youtube.com/embed/B1HEzNTGeZ4",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "18",
        title: "Density Column",
        subject: "science",
        level: "easy",
        class: "4-6",
        description: "Demonstrate density differences.",
        detailedProc: [
          "Gather liquids: honey, corn syrup, dish soap, water, vegetable oil, rubbing alcohol",
          "Add different food coloring to each liquid for visibility",
          "Pour honey first (densest) into tall clear glass",
          "Slowly pour corn syrup down the side using spoon",
          "Add dish soap similarly, then water, then oil, then alcohol",
          "Observe distinct layers based on density",
          "Try dropping small objects: bead, grape, plastic chip",
          "See which layer each object settles in",
          "Explain why oil floats on water",
          "Shake gently and watch layers re-form"
        ],
        videoLink: "https://www.youtube.com/embed/-CDkJuo_LYs",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "19",
        title: "Refraction of Light",
        subject: "science",
        level: "medium",
        class: "7-9",
        description: "Study bending of light.",
        detailedProc: [
          "Fill a glass with water",
          "Place a pencil in the water at an angle",
          "Observe how pencil appears bent at water surface",
          "Place a coin in empty cup, move until just hidden by rim",
          "Fill cup with water - coin becomes visible!",
          "Use laser pointer to shine light through water",
          "Measure angles of incidence and refraction",
          "Try different liquids: oil, sugar solution",
          "Create a rainbow with prism or CD",
          "Explain why swimming pool looks shallower than it is"
        ],
        videoLink: "https://www.youtube.com/embed/KU3A5cQPvB0",
        fileName: "",
        uploadDate: new Date().toISOString()
      },
      {
        id: "20",
        title: "Surface Area vs Volume",
        subject: "maths",
        level: "medium",
        class: "7-9",
        description: "Study cooling rates using geometry.",
        detailedProc: [
          "Cut potatoes into different shapes: cube, long rectangle, flat sheet",
          "Ensure all pieces have same volume (weight them)",
          "Heat pieces in microwave for 30 seconds",
          "Measure temperature immediately with thermometer",
          "Record temperature every minute for 10 minutes",
          "Plot cooling curves for each shape",
          "Calculate surface area to volume ratios",
          "Relate cooling rate to surface area",
          "Explain why small animals lose heat faster",
          "Apply to packaging design: why chips come in bags not boxes"
        ],
        videoLink: "https://www.youtube.com/embed/MCUbcfrqT8Y",
        fileName: "",
        uploadDate: new Date().toISOString()
      }
    ];
    function saveExperiment(exp) {
  fetch("/api/experiments", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      title: exp.title,
      description: exp.description,
      subject: exp.subject,
      level: exp.level,
      className: exp.class,
      procedure: exp.detailedProc,   // array of steps
      videoUrl: exp.videoLink
    })
  })
  .then(res => res.json())
  .then(data => {
    if (data.success) {
      alert("Experiment saved successfully âœ…");
    } else {
      alert("Failed to save experiment");
    }
  });
}

    
    let currentEditId = null;
    let procedureSteps = [];

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize procedure steps array
      procedureSteps = [];
      
      // Handle file selection
      document.getElementById('exp-file').addEventListener('change', function(e) {
        const fileName = e.target.files[0]?.name || 'No file selected';
        document.getElementById('file-name').textContent = fileName;
      });
      
      // Load experiments from server
      loadExperiments();
    });

    // Show section
    function showSection(id) {
  // This removes the 'active' class from EVERY section
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  
  // This adds 'active' ONLY to the one you clicked
  const target = document.getElementById(`${id}-section`);
  if (target) {
    target.classList.add('active');
  }
}

    // Add procedure step
    function addProcedureStep() {
      const input = document.getElementById('new-step-input');
      const stepText = input.value.trim();
      
      if (!stepText) {
        showMessage('Please enter a step description', 'error');
        return;
      }
      
      procedureSteps.push(stepText);
      renderProcedureSteps();
      input.value = '';
      input.focus();
    }

    // Remove procedure step
    function removeProcedureStep(index) {
      procedureSteps.splice(index, 1);
      renderProcedureSteps();
    }

    // Render procedure steps
    function renderProcedureSteps() {
      const container = document.getElementById('procedure-steps-container');
      container.innerHTML = '';
      
      if (procedureSteps.length === 0) {
        container.innerHTML = '<p style="color: var(--muted); font-style: italic; padding: 10px; text-align: center;">No steps added yet</p>';
        return;
      }
      
      procedureSteps.forEach((step, index) => {
        const stepItem = document.createElement('div');
        stepItem.className = 'step-item';
        stepItem.innerHTML = `
          <div style="display: flex; align-items: flex-start; flex: 1;">
            <span class="step-number">${index + 1}.</span>
            <span class="step-text">${step}</span>
          </div>
          <button type="button" onclick="removeProcedureStep(${index})">Remove</button>
        `;
        container.appendChild(stepItem);
      });
    }

    // Handle upload
    function handleUpload() {
      const title = document.getElementById('exp-title').value.trim();
      const description = document.getElementById('exp-description').value.trim();
      const subject = document.getElementById('exp-subject').value;
      const level = document.getElementById('exp-level').value;
      const classVal = document.getElementById('exp-class').value;
      const videoUrl = document.getElementById('exp-video').value.trim();
      const fileInput = document.getElementById('exp-file');
      
      // Validate required fields
      if (!title || !subject || !level || !classVal) {
        showMessage('Please fill in all required fields', 'error');
        return;
      }
      
      if (procedureSteps.length === 0) {
        showMessage('Please add at least one procedure step', 'error');
        return;
      }
      
      // Show loading state
      const uploadBtn = document.getElementById('upload-btn');
      const originalText = uploadBtn.textContent;
      uploadBtn.textContent = 'Adding...';
      uploadBtn.disabled = true;
      
      // Create FormData for file upload
      const formData = new FormData();
      formData.append('title', title);
      formData.append('description', description);
      formData.append('subject', subject);
      formData.append('level', level);
      formData.append('class', classVal);
      formData.append('procedure', JSON.stringify(procedureSteps));
      formData.append('videoLink', videoUrl);
      if (fileInput.files[0]) {
        formData.append('file', fileInput.files[0]);
      }
      
      // Upload to server
      fetch('/api/upload', {
        method: 'POST',
        body: formData,
        credentials: 'include'
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          // Reset form
          document.getElementById('exp-title').value = '';
          document.getElementById('exp-description').value = '';
          document.getElementById('exp-subject').value = '';
          document.getElementById('exp-level').value = '';
          document.getElementById('exp-class').value = '';
          document.getElementById('exp-video').value = '';
          procedureSteps = [];
          renderProcedureSteps();
          document.getElementById('file-name').textContent = 'No file selected';
          
          // Show success message
          showMessage('Experiment added successfully!', 'success');
          
          // Reset button
          uploadBtn.textContent = originalText;
          uploadBtn.disabled = false;
          
          // Clear edit mode
          currentEditId = null;
          uploadBtn.textContent = 'Add Experiment';
          
          // Reload experiments from server
          loadExperiments();
          
          // Switch to experiments section
          setTimeout(() => {
            showSection('experiments');
          }, 1500);
        } else {
          showMessage(data.error || 'Failed to upload experiment', 'error');
          uploadBtn.textContent = originalText;
          uploadBtn.disabled = false;
        }
      })
      .catch(err => {
        console.error('Upload error:', err);
        showMessage('Error uploading experiment. Please try again.', 'error');
        uploadBtn.textContent = originalText;
        uploadBtn.disabled = false;
      });
    }
    
    // Load experiments from server
    function loadExperiments() {
      fetch('/api/experiments', {
        credentials: 'include'
      })
      .then(res => res.json())
      .then(data => {
        if (data.error) {
          console.error('Error loading experiments:', data.error);
          return;
        }
        
        // Convert API data to local format
        experiments = data.map(exp => ({
          id: exp.id.toString(),
          title: exp.title,
          description: exp.description || '',
          subject: exp.subject || 'science',
          level: exp.level || 'easy',
          class: exp.class || '4-6',
          detailedProc: exp.detailedProc || [],
          videoLink: exp.videoLink || exp.video_link || '',
          fileName: exp.file_name || '',
          uploadDate: exp.uploaded_at || new Date().toISOString()
        }));
        
        // Save to localStorage as backup
        localStorage.setItem('experiments', JSON.stringify(experiments));
        
        // Render experiments
        renderExperiments(experiments);
      })
      .catch(err => {
        console.error('Error fetching experiments:', err);
      });
    }

    // Render experiments grid
    function renderExperiments(experimentsList) {
      const grid = document.getElementById('experiments-grid');
      
      if (experimentsList.length === 0) {
        grid.innerHTML = '<div class="no-data">No experiments added yet. Add your first experiment!</div>';
        return;
      }
      
      let html = '';
      experimentsList.forEach(exp => {
        const severityBadge = exp.level === 'easy' ? 'ðŸŸ¢ Safe' : 'ðŸŸ  Caution';
        html += `
          <div class="card" id="exp-${exp.id}">
            <div class="card-actions">
              <button class="card-action-btn edit" onclick="editExperiment('${exp.id}')" title="Edit">
                âœï¸
              </button>
              <button class="card-action-btn delete" onclick="deleteExperiment('${exp.id}')" title="Delete">
                ðŸ—‘ï¸
              </button>
            </div>
            <h4>${exp.title}</h4>
            <div class="tags">
              <span class="tag subject-${exp.subject}">${exp.subject}</span>
              <span class="tag level-${exp.level}">${exp.level}</span>
              <span class="tag">${exp.class}</span>
              <span class="tag" style="background: rgba(255,255,255,.08);">${severityBadge}</span>
            </div>
            <p>${exp.description || 'No description provided'}</p>
            <div class="card-footer">
              <span>${new Date(exp.uploadDate).toLocaleDateString()}</span>
              <button class="btn" onclick="viewExperiment('${exp.id}')" style="padding: 6px 12px; font-size: 12px;">View Details</button>
            </div>
          </div>
        `;
      });
      
      grid.innerHTML = html;
    }

    // Edit experiment
    function editExperiment(id) {
      const experiment = experiments.find(exp => exp.id === id);
      if (!experiment) return;
      
      // Populate form
      document.getElementById('exp-title').value = experiment.title;
      document.getElementById('exp-description').value = experiment.description || '';
      document.getElementById('exp-subject').value = experiment.subject;
      document.getElementById('exp-level').value = experiment.level;
      document.getElementById('exp-class').value = experiment.class;
      document.getElementById('exp-video').value = experiment.videoLink || '';
      
      // Set procedure steps
      procedureSteps = [...experiment.detailedProc];
      renderProcedureSteps();
      
      // Set edit mode
      currentEditId = id;
      document.getElementById('upload-btn').textContent = 'Update Experiment';
      
      // Scroll to top
      window.scrollTo(0, 0);
      
      // Switch to upload section
      showSection('upload');
      
      // Show message
      showMessage('Edit mode activated. Update the experiment details.', 'info');
    }

    // Delete experiment
    async function deleteExperiment(id) {
      if (!confirm('Are you sure you want to delete this experiment?')) return;
      try {
        const response = await fetch(`/api/experiments/${id}`, {
          method: 'DELETE'
        });
        const data = await response.json();
        if (data.success) {
          showMessage('Experiment deleted successfully', 'success');
          // Change fetchExperiments() to loadExperiments()
          await loadExperiments(); 
        } else {
          showMessage('Delete failed: ' + data.message, 'error');
        }
      } catch (err) {
        console.error('Delete error:', err);
        showMessage('Error connecting to server', 'error');
      }
    }


    // View experiment details
    function viewExperiment(id) {
      const experiment = experiments.find(exp => exp.id === id);
      if (!experiment) return;
      
      // Populate modal
      document.getElementById('m-title').textContent = experiment.title;
      document.getElementById('m-desc').textContent = experiment.description || '';
      
      // Populate procedure
      const procedureList = document.getElementById('m-procedure');
      procedureList.innerHTML = '';
      experiment.detailedProc.forEach((step, i) => {
        const li = document.createElement('li');
        li.textContent = step;
        li.className = 'procedure-step';
        procedureList.appendChild(li);
      });
      
      // Handle video
      const videoContainer = document.getElementById('video-container');
      videoContainer.innerHTML = '';
      
      if (experiment.videoLink) {
        const iframe = document.createElement('iframe');
        iframe.src = experiment.videoLink;
        iframe.width = "100%";
        iframe.height = "400";
        iframe.frameBorder = "0";
        iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
        iframe.allowFullscreen = true;
        iframe.style.borderRadius = "12px";
        iframe.style.border = "1px solid rgba(255,255,255,0.1)";
        videoContainer.appendChild(iframe);
      } else {
        const placeholder = document.createElement('div');
        placeholder.className = 'video-placeholder';
        placeholder.innerHTML = `
          <div style="font-size: 48px; margin-bottom: 10px;">ðŸ“¹</div>
          <h4>No Video Available</h4>
          <p>No video demonstration provided for this experiment.</p>
        `;
        videoContainer.appendChild(placeholder);
      }
      
      // Show modal
      document.getElementById('modal').style.display = 'flex';
    }

    // Close modal
    function closeModal() {
      document.getElementById('modal').style.display = 'none';
      // Stop any playing videos
      const iframe = document.querySelector('#video-container iframe');
      if (iframe) {
        iframe.src = iframe.src; // Reset to stop video
      }
    }

    // Filter experiments
    function filterExperiments() {
      const searchTerm = document.getElementById('f-search').value.toLowerCase();
      const subjectFilter = document.getElementById('f-subject').value;
      const levelFilter = document.getElementById('f-level').value;
      const classFilter = document.getElementById('f-class').value;
      
      const filtered = experiments.filter(exp => {
        // Search filter
        if (searchTerm && 
            !exp.title.toLowerCase().includes(searchTerm) && 
            !exp.description.toLowerCase().includes(searchTerm) &&
            !exp.detailedProc.some(step => step.toLowerCase().includes(searchTerm))) {
          return false;
        }
        
        // Subject filter
        if (subjectFilter !== 'all' && exp.subject !== subjectFilter) return false;
        
        // Level filter
        if (levelFilter !== 'all' && exp.level !== levelFilter) return false;
        
        // Class filter
        if (classFilter !== 'all' && exp.class !== classFilter) return false;
        
        return true;
      });
      
      renderExperiments(filtered);
    }

    // Clear filters
    function clearFilters() {
      document.getElementById('f-search').value = '';
      document.getElementById('f-subject').value = 'all';
      document.getElementById('f-level').value = 'all';
      document.getElementById('f-class').value = 'all';
      
      renderExperiments(experiments);
    }

    // Show message
    function showMessage(text, type) {
      const messageDiv = document.getElementById('upload-message');
      messageDiv.textContent = text;
      messageDiv.className = `message ${type}`;
      
      // Auto-hide success messages after 3 seconds
      if (type === 'success') {
        setTimeout(() => {
          messageDiv.textContent = '';
          messageDiv.className = 'message';
        }, 3000);
      }
    }
  </script>
</body>
</html>